<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3" lang="">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>OpenDelos Live</title>
    <link rel="stylesheet" th:href="@{/css/global.css}"/>
    <!-- CoreUI CSS -->
    <link rel="stylesheet" th:href="@{/lib/coreui/coreui.min.css}"/>
    <link rel="stylesheet" th:href="@{/lib/coreui/free.min.css}"/>

    <link rel="stylesheet" type="text/css" th:href="@{/css/wcag/wcag.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/font-css/delos.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/delos/search.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/delos/navbar.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/fontawesome/css/all.min.css}"/>
    <!-- classic theme datatable with various plugins -->
    <link rel="stylesheet" type="text/css" th:href="@{/lib/datatables-classic/datatables.min.css}"/>
    <!-- select2 -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/select2/css/select2.min.css}"/>
    <!-- alertify -->
    <link rel="stylesheet" th:href="@{/lib/alertify/css/alertify.min.css}"/>
    <link rel="stylesheet" th:href="@{/lib/alertify/css/themes/bootstrap.min.css}"/>
</head>
<body class="c-app">
<input type="hidden" id="institutionIdentity" th:value="${institution_identity}"/>
<input type="hidden" id="institutionTitle" th:value="#{default.institution.title}"/>
<input type="hidden" id="editor_id" th:value="${user.id}"/>
<input type="hidden" id="editor_name" th:value="${user.name}"/>
<input type="hidden" id="isStaffMember" th:value="${user_isStaffMember}"/>
<input type="hidden" id="isManager" th:value="${user_isManager}"/>
<input type="hidden" id="user_access" th:value="${user_access}"/>
<input type="hidden" id="cpage"            th:value="${cpage}" />
<input type="hidden" id="upload_base_path" value="/delosrc/resources/ml/"/> <!-- TODO  :: PUT TO MODEL -->

<input type="hidden" id="department_filter" th:value="${departmentFilter.id}"/>
<input type="hidden" id="department_filter_name" th:value="${departmentFilter.text}"/>
<input type="hidden" id="staff_filter" th:value="${staffMemberFilter.id}"/>
<input type="hidden" id="staff_filter_name" th:value="${staffMemberFilter.text}"/>

<input type="hidden" id="area_filter" th:value="${areaFilter}"/>
<input type="hidden" id="area_filter_name" th:value="${areaFilterName}"/>

<input type="hidden" id="etype_filter" th:value="${etypeFilter}"/>
<input type="hidden" id="etype_filter_name" th:value="${etypeFilterName}"/>


<!--<div th:replace="~{admin/fragments/a-sidebar-content :: a-sidebar}"></div>-->
<div class="c-wrapper">
    <div th:replace="~{admin/fragments/a-topnav :: a-topnav}"></div>
    <nav class="navbar navbar-expand navbar-light py-0" style="background-color:white;margin-top: 50px!important;">
        <div class="collapse navbar-collapse" id="subBar">
            <div class="navbar-nav">
                Περιεχόμενο ::
            </div>
            <div class="navbar-nav">
                <a class="nav-item nav-link" th:href="@{/admin/search}"><span class="fas fa-search mr-1"></span>Αναζήτηση </a>
                <a class="nav-item nav-link active" th:href="@{/admin/sevents}"><span class="fas fa-calendar-alt mr-1"></span>Κατάλογος Εκδηλώσεων <span class="sr-only">(current)</span></a>
                <a class="nav-item nav-link" th:href="@{/admin/lecture-editor}"><span class="fas fa-plus mr-1"></span>Νέα Διάλεξη</a>
                <a class="nav-item nav-link" th:href="@{/admin/event-editor}"><span class="fas fa-plus mr-1"></span>Νέο Πολυμέσο Εκδήλωσης</a>
            </div>
            <ul class="c-header-nav ml-auto" style="min-height: 20px!important">
                <th:block sec:authorize="hasRole('ROLE_SA') || hasRole('ROLE_MANAGER') || hasRole('ROLE_STAFFMEMBER')">
<!--                    <a  class="c-sidebar-nav-link" th:href="@{/admin/sevent-editor}">
                        <i class="fas fa-plus mr-1 font-weight-bolder"></i> Νέα Εκδήλωση
                    </a>-->
                </th:block>
            </ul>
        </div>
    </nav>
    <div class="header-divider py-0"></div>

    <div class="c-body">
        <main class="c-main pt-0">
            <div class="container-fluid">
                <div class="row">
                    <div class="offset-1 col-lg-10" id="content">
                        <div class="card">
                            <div class="card-header px-0">
                                <h4>Κατάλογος Εκδηλώσεων</h4>
                                <div class="text-muted font-italic">
                                    Διαχείριση Εκδηλώσεων
                                </div>
                                <div class="row">
                                    <div class="col-12 text-right">
                                        <a  class="new-button btn" role="button" th:href="@{/admin/sevent-editor}" title="Δημιουργία νέας Εκδήλωσης">
                                            <i class="fas fa-plus mr-1 font-weight-bolder"></i> Νέα Εκδήλωση
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body px-0 pt-0">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="container mt-3">
                                            <div th:replace="~{admin/content/scheduled_events/fragments/sevents-search-nav :: a-search-nav}"></div>
                                        </div>
                                        <th:block th:if="${QR != null}">
                                          <!--  <div th:replace="~{fragments/search-common/ontop-applied-filters :: ontop-applied-filters}">Applied Filters</div>-->
                                        </th:block>
                                        <th:block th:if="${QR != null && QR.totalResults >0}">
                                            <div class="row">
                                                <div class="col-6">
                                                    <span class="float-left text-muted">
                                                        <span th:text="${'Εμφάνιση ' + (QR.skip+1)} + '-'"></span>
                                                        <span th:if="${QR.totalResults < (QR.skip+QR.limit)}"><span th:text="${QR.totalResults}"></span></span>
                                                        <span th:unless="${QR.totalResults < (QR.skip+QR.limit)}"><span th:text="${(QR.skip + QR.limit)}"></span></span>
                                                        <span th:text="${' από ' + QR.totalResults}"></span>
                                                    </span>
                                                </div>
                                                <div class="col-6">
                                                    <div th:replace="~{fragments/search/u-sort-and-display-sevents :: u-sort-and-display}"></div>
                                                </div>
                                            </div>
                                            <!-- Pager -->
                                            <div class="row my-1">
                                                <div class="col-12 text-center">
                                                    <div th:replace="~{fragments/search-common/u-pager :: u-pager('false')}">Pager</div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-12">
                                                    <div th:if="${QR.skip > 1000}">
                                                        Δεν επιτρέπεται η εξυπηρέτηση περισσότερων από 1000 αποτελεσμάτων τη φορά. Περιορίστε τον αριθμό των αποτελεσμάτων προσθέτοντας νέα κριτήρια αναζήτησης
                                                        (Ζητήσατε αποτελέσματα μετά τα <span th:text="${QR.skip}"></span>)
                                                    </div>
                                                    <!--@thymesVar id="QR" type="org.opendelos.model.repo.QueryResourceResults"-->
                                                    <div th:unless="${QR.skip > 1000}">
                                                        <!--@thymesVar id="scheduledEvent" type="org.opendelos.model.resources.ScheduledEvent"-->
                                                        <div th:each="scheduledEvent, iStat: ${QR.searchResultList}" th:style="${iStat.odd}? ''">

                                                            <div class="card p-0 my-1" th:attr="data-lec=${scheduledEvent.id}">
                                                                <div class="card-body py-0 px-0">
                                                                    <div class="row row-style mb-2">
                                                                        <div class="col-md-9 col-sm-12 col-lg-9">
                                                                                 <div style="font-size: 1.1em">
                                                                                    <span style="font-size: 1.1em;color:#006A9B;font-weight: 550" th:text="${(iStat.count+QR.skip) + '. ' + scheduledEvent.title}"></span>
                                                                                </div>
                                                                                <div>
                                                                                    <i class="far fa-calendar-alt mr-1"></i>
                                                                                    <span style="font-weight: 500" th:if="${scheduledEvent.endDate != null && scheduledEvent.endDate != '' &&
                                                                                         scheduledEvent.startDate != scheduledEvent.endDate }"
                                                                                         th:text="${#temporals.format(scheduledEvent.startDate, 'dd-MMMM-YYYY') + ' έως '
                                                                                         + #temporals.format(scheduledEvent.endDate, 'dd-MMMM-YYYY')}">
                                                                                    </span>
                                                                                    <span style="font-weight: 500"  th:unless="${scheduledEvent.endDate != null && scheduledEvent.endDate != '' &&
                                                                                                        scheduledEvent.startDate != scheduledEvent.endDate }"
                                                                                         th:text="${#temporals.format(scheduledEvent.startDate, 'dd-MMMM-YYYY')}">
                                                                                    </span>
                                                                                    <span th:if="${scheduledEvent.place != null && scheduledEvent.place != '' }">
                                                                                          <i class="fas fa-map-marker-alt mr-1 ml-2"></i><span th:text="${scheduledEvent.place}"></span>
                                                                                    </span>
                                                                                </div>
                                                                                <div class="row mt-3">
                                                                                    <div class="col-12">
                                                                                        <div class="mb-2">
                                                                                            <div th:if="${scheduledEvent.responsibleUnit != null}" style="color:black;font-style: italic" class="text-muted ml-1">
                                                                                                <b>Διοργανωτές:</b>
                                                                                                <span th:each="unit,iStat: ${scheduledEvent.responsibleUnit}">
                                                                                             <span th:text="${iStat.first}? '' : ', '"></span>
                                                                                             <span th:if="${#strings.trim(unit.structureType) == 'DEPARTMENT'}"> Τμήμα</span>
                                                                                             <span th:if="${#strings.trim(unit.structureType) == 'SCHOOL'}"> Σχολή </span>
                                                                                             <span th:text="${unit.title + ' '}"></span>
                                                                                         </span>
                                                                                            </div>
                                                                                            <div th:if="${scheduledEvent.responsiblePerson != null}" class="mb-2 font-italic ml-1 text-muted">
                                                                                                <b>Επιστημονικός Υπεύθυνος ή Εκπρόσωπος:</b>
                                                                                                <span th:text="${scheduledEvent.responsiblePerson.name + ', ' + scheduledEvent.responsiblePerson.affiliation }"></span>
                                                                                            </div>

                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="mt-3" style="font-size: 1em">
                                                                                    <span th:if="${scheduledEvent.isActive}" title="Ενεργό Ημερολόγιο">
                                                                                            <i class="fas fa-power-off" style="color: green"></i> Ενεργό Ημερολόγιο
                                                                                    </span>
                                                                                    <span th:unless="${scheduledEvent.isActive}" title="Ανενεργό Ημερολόγιο">
                                                                                            <i class="fas fa-power-off" style="color:red"></i> Ανενεργό Ημερολόγιο
                                                                                    </span>
                                                                                    <span class="ml-3" th:if="${scheduledEvent.isFeatured}" title="Προβεβλημένη Εκδήλωση">
                                                                                            <i class="fas fa-exclamation" style="color: red"></i> Προβεβλημένη Εκδήλωση
                                                                                    </span>
                                                                                     <i th:if="${scheduledEvent.area}" class="fas fa-quote-right ml-3"></i>
                                                                                     <span th:if="${scheduledEvent.area}" th:text="#{${scheduledEvent.area}}"></span>
                                                                                     <i th:if="${scheduledEvent.type}" class="fas fa-quote-right ml-3"></i>
                                                                                     <span th:if="${scheduledEvent.type}" th:text="#{${scheduledEvent.type}}"></span>


                                                                                     <i th:if="${scheduledEvent.categories}" class="fas fa-quote-right ml-3"></i>
                                                                                     <span th:if="${scheduledEvent.categories}" th:each="thema: ${scheduledEvent.categories}">
                                                                                        <span class="mx-1" th:text="#{${thema}}"></span>
                                                                                     </span>
                                                                                </div>
                                                                        </div>
                                                                        <div class="col-md-3 col-sm-12 col-lg-3 row-buttons">
                                                                            <div class="row">
                                                                                <div class="col-12">
                                                                                    <div class="button-line">
                                                                                        <a href="#" role="button" class=" btn btn-sm btn-pill blue-btn-wcag-bgnd-color text-white"
                                                                                           title="Επεξεργασία στοιχείων Εκδήλωσης"
                                                                                           th:href="@{/admin/sevent-editor(id=${scheduledEvent.id})}">
                                                                                            <i class="fas fa-edit"></i>
                                                                                        </a> Επεξεργασία
                                                                                    </div>
                                                                                    <div class="button-line">
                                                                                        <a href="#" role="button" class=" btn btn-sm btn-pill btn-secondary"
                                                                                           title="Αναζήτηση καταγραφών της εκδήλωσης"
                                                                                           th:href="@{/admin/search(e=${scheduledEvent.id})}">
                                                                                            <i class="fas fa-search"></i>
                                                                                        </a> Αναζήτηση Καταγραφών
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- Pager -->
                                                    <div class="row my-3">
                                                        <div class="col-12 text-center">
                                                            <div th:replace="~{fragments/search-common/u-pager :: u-pager('true')}">Pager</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </th:block>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <footer class="c-footer">
        <i class="far fa-copyright mr-1"></i> <span th:text="#{default.institution.title}"></span>
    </footer>
</div>

<div th:replace="~{modals/staff_select_modal :: staffmember_select_modal}"></div>
<div th:replace="~{modals/logout_modal :: #logout_modal}"></div>

<!-- Optional JavaScript -->

<script th:src="@{/js/i18n/el.js}" type="application/javascript"></script>
<script th:src="@{/css/jquery-3.5.1/jquery-3.5.1.js}" type="application/javascript"></script>
<script th:src="@{/lib/coreui/coreui.bundle.min.js}"></script>
<script th:src="@{/lib/coreui/coreui-utilities.min.js}"></script>

<!-- plupload -->
<script type="text/javascript" th:src="@{/lib/plupload-2.3.6/js/plupload.full.min.js}"></script>
<!-- DataTables -->
<script th:src="@{/lib/datatables-classic/datatables.min.js}" type="application/javascript"></script>
<script th:src="@{/lib/datatables-classic/row().show().js}" type="application/javascript"></script>
<!-- TESTING LISTNAV -->
<script th:src="@{/lib/datatables-listnav/jquery.dtListNav.dt1.10.js}" type="application/javascript"></script>
<!-- Select2 -->
<script th:src="@{/css/select2/js/select2.full.js}" type="application/javascript"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
<!-- alertify -->
<script th:src="@{/lib/alertify/alertify.min.js}"></script>

<script th:src="@{/js/admin/content/sevents/dashboard.js}" type="application/javascript"></script>
<script th:src="@{/js/admin/content/sevents/dashboard.sevents.js}" type="application/javascript"></script>
<script th:src="@{/js/admin/content/sevents/dashboard.departments.js}" type="application/javascript"></script>
<script th:src="@{/js/admin/content/sevents/dashboard.staffmembers.js}" type="application/javascript"></script>
<script th:src="@{/js/admin/content/sevents/dashboard.areas.js}" type="application/javascript"></script>

<script th:src="@{/js/search/el.js}" type="application/javascript"></script>
<script th:src="@{/css/moment/moment.min.js}" type="text/javascript" ></script>
<script th:src="@{/css/moment/en-gb.js}" type="text/javascript" ></script>
<script th:src="@{/css/moment/el.js}" type="text/javascript" ></script>

</body>
</html>