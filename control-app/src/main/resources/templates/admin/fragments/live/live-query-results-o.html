<!DOCTYPE html>
<html lang="" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<!--@thymesVar id="QR" type="org.opendelos.dashboard.repository.resource.QueryResourceResults"-->
<div th:fragment="live-query-results" id="live_results">
    <div th:each="lecture, iStat: ${QR.searchResultList}" th:style="${iStat.odd}? ''">
        <div class="row row-style player_tab">
                <div th:if="${lecture.type == 'COURSE'}" class="st_data" th:attr="data-ss=${lecture.streamingServerId},data-st=${lecture.streamId},data-title=${lecture.title},data-did=${lecture.department.id},data-dt=${lecture.department.title},data-sn=${lecture.supervisor.name}">
                </div>
                <div th:if="${lecture.type == 'EVENT'}" class="st_data"  th:attr="data-ss=${lecture.streamingServerId},data-st=${lecture.streamId},data-title=${lecture.title},data-did=${lecture.getEvent.responsiblePerson.department.id},data-dt=${lecture.getEvent.responsiblePerson.department.title},data-sn=${lecture.getEvent.responsiblePerson.name}">
                </div>

            <div class="col-lg-1 col-md-2 col-sm-2 col-xs-2 px-0" style="text-align: center" >
                <div class="live_day" style="color:red" th:text="${#temporals.format(lecture.date, 'HH:mm')}"></div>
                <div class="icon-live-lecture" style="color: red;font-size: 1.5em"></div>
            </div>
            <div class="col-lg-8 col-md-10 col-sm-10 col-xs-10">
                <div style="color:#006A9B">
                    <span style="font-weight: bolder" th:text="${iStat.count + '.'}"></span>
                    <strong><span style="font-size: 1.1em" th:text="${lecture.title}"></span></strong>
                    <span th:if="${lecture.course != null}" class="mb-2" style="font-weight: 600">
                                                        <span th:text="${'[' + lecture.supervisor.name}"></span>
                                            </span>
                    <span th:if="${lecture.course != null}" class="mb-2">
                                                        <span th:text="${', ' + lecture.supervisor.affiliation + ']'}"></span>
                                            </span>
                    <span th:if="${lecture.partNumber != 0}">
                                                         <span th:text="${'- Μέρος ' + lecture.partNumber}"></span>
                                            </span>
                </div>
                <div th:if="${lecture.course != null}" class="mb-2 font-weight-bolder">
                    <span class="course_item" th:text="${' Τμήμα ' + lecture.department.title}"></span>
                    <div style="font-weight: normal;font-style: italic" class="text-muted mt-2">
                        <i class="fas fa-quote-left fa-pull-left"></i>
                        <span th:text="${(#strings.trim(lecture.description) != '' && lecture.description != null) ? lecture.description:'χωρίς περιγραφή'}"></span>
                    </div>
                </div>
                <div th:if="${lecture.getEvent != null}" class="mb-2">
                    <i class="icon-event" style="color: #555555" title="εκδήλωση"></i><span  class="font-italic"  th:text="${lecture.getEvent.title}"></span>
                    <div th:if="${lecture.getEvent.responsibleUnit != null}" style="color:black;font-style: italic" class="text-muted ml-1">
                                                     <span th:each="unit,iStat: ${lecture.getEvent.responsibleUnit}">
                                                         <span th:text="${iStat.first}? '' : ', '"></span>
                                                         <span th:if="${#strings.trim(unit.structureType) == 'DEPARTMENT'}"> Τμήμα</span>
                                                         <span th:if="${#strings.trim(unit.structureType) == 'SCHOOL'}"> Σχολή </span>
                                                         <span th:text="${unit.title + ' '}"></span>
                                                     </span>
                    </div>
                    <div style="font-weight: normal;font-style: italic" class="text-muted mt-2">
                        <i class="fas fa-quote-left fa-pull-left"></i>
                        <span th:text="${(#strings.trim(lecture.description) != '' && lecture.description != null) ? lecture.description:'χωρίς περιγραφή'}"></span>
                    </div>
                </div>
                <div class="mt-3">
                    <span th:if="${lecture.broadcast}">
                        <img width="16px" th:src="@{/public/images/icons/IconMetadosiOn.png}" alt="" src=""> Μετάδοση -
                    </span>
                    <span th:unless="${lecture.broadcast}">
                        <img width="16px" th:src="@{/public/images/icons/IconMetadosiOff.png}" alt="" src=""> Χωρίς Μετάδοση
                    </span>
                    <span th:if="${lecture.access == 'open'}">
                        <i class="fas fa-lock-open"></i> Ανοικτή
                    </span>
                    <span th:if="${lecture.access == 'sso'}">
                        <i class="fas fa-lock"></i> Ιδρυματικό Λογαριασμό
                    </span>
                    <span th:if="${lecture.access == 'password'}">
                        <i class="fas fa-lock"></i> Κωδικό
                    </span> |
                    <span th:if="${lecture.recording}">
                        <img width="16px" th:src="@{/public/images/icons/IconRecAuto.png}" alt="" src=""> Καταγραφή
                    </span>
                    <span th:unless="${lecture.recording}">
                        <img width="16px" th:src="@{/public/images/icons/IconRecOff.png}" alt="" src=""> Χωρίς Καταγραφή
                    </span>
                    <br/>
                    <b>Έναρξη: </b>
                    <div th:replace="fragments/format-resource-date.html:: formatDateTime (field=${lecture.date})"></div> |
                    <b>Διάρκεια: </b>
                    <span th:text="${lecture.realDuration}" title="διάρκεια"></span> |
                    <b>Αίθουσα/Χώρος: </b>
                    <span th:text="${lecture.classroomName}" title="αίθουσα/χώρος"></span>
                </div>
            </div>
            <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12 mt-3 px-0">
                <th:block th:if="${lecture.access == 'open'}">
                    <th:block th:if="${lecture.broadcastToChannel}">
                        <a  role="button" title="Προβολή ζωντανής μετάδοσης" class="btn blue-btn-wcag-bgnd-color play_live" style="width: 100%;color: whitesmoke;display: none"
                            target="_blank" href="#" th:href="@{/live_channel}">
                            <i class="fas fa-play"></i> Κανάλι Εκδηλώσεων
                        </a>
                    </th:block>
                    <th:block th:unless="${lecture.broadcastToChannel}">
                        <a  role="button" title="Προβολή ζωντανής μετάδοσης" class="btn blue-btn-wcag-bgnd-color play_live" style="width: 100%;display: none;color: whitesmoke"
                            target="_blank" href="#" th:href="@{/live_player(id=${lecture.id})}">
                            <i class="fas fa-play"></i> Αναπαραγωγή
                        </a>
                    </th:block>
                </th:block>
                <th:block th:if="${lecture.access == 'sso'}">
                    <a role="button" title="Προβολή ζωντανής μετάδοσης" class="btn blue-btn-wcag-bgnd-color play_live" style="width: 100%;display: none;color: whitesmoke"
                       target="_blank" href="#" th:href="@{/cas/live_player(id=${lecture.id})}">
                        <i class="fas fa-play"></i> Αναπαραγωγή
                    </a>
                </th:block>
                <th:block th:if="${lecture.access == 'password'}">
                    <a role="button" title="Προβολή ζωντανής μετάδοσης" class="btn blue-btn-wcag-bgnd-color play_live" style="width: 100%;display: none;color: whitesmoke"
                       target="_blank" href="#" th:href="@{/secure/live_player(id=${lecture.id})}">
                        <i class="fas fa-play"></i> Αναπαραγωγή
                    </a>
                </th:block>
                <th:block sec:authorize="hasRole('ROLE_SA')">
                    <a role="button" title="έκτακτη διακοπή μετάδοσης" class="btn btn-danger mt-1 stop_live"
                       style="width: 100%;display: none;color: whitesmoke" target="_blank"
                       href="#" th:attr="data-target=${lecture.id},data-rec=${lecture.recording},data-title=${lecture.title}">
                        <i class="fas fa-stop" style="color: #006A9B "></i> Διακοπή
                    </a>
                </th:block>
            </div>
        </div>

    </div>
</div>
